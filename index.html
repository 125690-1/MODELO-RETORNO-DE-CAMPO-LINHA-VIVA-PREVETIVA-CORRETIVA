<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MODELO RETORNO DE CAMPO LINHA VIVA</title>
  <link rel="icon" href="pesada.png" type="image/png">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>
  <style>
    /* (mantenha aqui todos os seus estilos CSS do formulário original) */
  </style>
</head>
<body>
  <!-- (todo o conteúdo original do formulário continua aqui) -->

  <div class="share-buttons">
    <button id="whatsappButton" class="button-enviarWhatsApp" onclick="enviarWhatsApp()" disabled>Encaminhar para WhatsApp</button>
    <button id="pdfButton" class="button-default" onclick="savePdf()">Salvar PDF</button>
    <button class="button-default" onclick="enviarParaSheetDB()">Salvar Informações</button>
  </div>

  <!-- (demais partes como rodapé, overlay, etc) -->

  <script>
    // (todo o seu script original permanece aqui...)

    function enviarParaSheetDB() {
      const data = {
        pessoa: document.getElementById("pessoa").value,
        lead: document.getElementById("lead").value,
        br1: document.getElementById("br1").value,
        ot_ane: document.getElementById("ot_ane").value,
        sgm: document.getElementById("sgm").value,
        data_execucao: document.getElementById("data").value,
        ba: document.getElementById("ba").value,
        sgd: document.getElementById("sgd").value,
        inc: document.getElementById("inc").value,
        dt: document.getElementById("dt").value,
        apr: document.getElementById("apr").value,
        apr2: document.getElementById("apr2").value,
        cincoRO: document.getElementById("cincoRO-input").value,
        traf: document.getElementById("traf").value,
        tomb: document.getElementById("Tomb").value,
        estrutur: document.getElementById("estrut").value,
        alim: document.getElementById("alim").value,
        endereco: document.getElementById("endereco").value,
        hora_inicio: document.getElementById("start-time").value,
        hora_fim: document.getElementById("end-time").value,
        servico: document.getElementById("descricaoServico").value,
        material: document.getElementById("descricaoMaterial").value,
        sucata: document.getElementById("descricaoSucata").value,
        recurso: document.getElementById("descricaoRecurso").value
      };

      fetch("https://sheetdb.io/api/v1/tvshuzgwt1vmh", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ data: data })
      })
      .then(response => response.json().then(json => {
        if (response.ok) {
          alert("✅ Informações enviadas com sucesso para a planilha!");
          console.log("Resposta da API:", json);
        } else {
          alert("❌ Falha ao enviar dados. Verifique os nomes dos campos.");
          console.error("Erro na resposta:", json);
        }
      }))
      .catch(error => {
        console.error("Erro ao enviar dados:", error);
        alert("❌ Erro ao enviar os dados.");
      });
    }
  </script>
</body>
</html>
